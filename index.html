<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Ralph</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Prevent flash of unstyled content */
        html {
            visibility: hidden;
        }
        
        html.loaded {
            visibility: visible;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #f8fafc;
            min-height: 100vh;
            color: #1e293b;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 50px;
            border-bottom: 1px solid #e2e8f0;
            padding-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 8px;
            color: #0f172a;
        }

        .header p {
            font-size: 1.1rem;
            color: #64748b;
            font-weight: 400;
        }

        .date-display {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 16px 24px;
            margin-bottom: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .current-date {
            font-size: 1.1rem;
            font-weight: 600;
            color: #0f172a;
        }

        .days-until-launch {
            background: #3b82f6;
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.875rem;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 24px;
            margin-bottom: 40px;
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 32px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border: 1px solid #e2e8f0;
            transition: all 0.2s ease;
        }

        .card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid #f1f5f9;
        }

        .card-icon {
            width: 48px;
            height: 48px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 16px;
            font-size: 1.25rem;
            color: white;
            background: #3b82f6;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #0f172a;
        }

        .progress-section {
            margin-bottom: 24px;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e2e8f0;
            border-radius: 3px;
            overflow: hidden;
            margin: 12px 0;
        }

        .progress-fill {
            height: 100%;
            background: #3b82f6;
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            font-size: 0.875rem;
            color: #64748b;
            font-weight: 500;
        }

        .status-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-active {
            background: #dbeafe;
            color: #1d4ed8;
        }

        .status-completed {
            background: #dcfce7;
            color: #15803d;
        }

        .status-pending {
            background: #fef3c7;
            color: #d97706;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 16px;
            margin-top: 20px;
        }

        .metric {
            text-align: center;
            padding: 20px 16px;
            background: #f8fafc;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .metric:hover {
            background: #f1f5f9;
            transform: translateY(-1px);
        }

        .metric-value {
            font-size: 1.75rem;
            font-weight: 700;
            color: #0f172a;
            margin-bottom: 4px;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 4px;
            transition: background 0.2s ease;
        }

        .metric-value:hover {
            background: #f1f5f9;
        }

        .metric-value.editing {
            background: white;
            border: 2px solid #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .metric-input {
            font-size: 1.75rem;
            font-weight: 700;
            color: #0f172a;
            background: transparent;
            border: none;
            outline: none;
            width: 100%;
            text-align: center;
            font-family: inherit;
        }

        .metric-label {
            font-size: 0.75rem;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 500;
        }

        .timeline {
            margin-top: 24px;
        }

        .timeline-item {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
            padding: 16px;
            border-radius: 8px;
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .timeline-item:hover {
            background: #f1f5f9;
            border-color: #3b82f6;
        }

        .timeline-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 16px;
            flex-shrink: 0;
        }

        .timeline-dot.completed {
            background: #10b981;
        }

        .timeline-dot.active {
            background: #3b82f6;
        }

        .timeline-dot.pending {
            background: #f59e0b;
        }

        .timeline-content {
            flex: 1;
        }

        .timeline-title {
            font-weight: 600;
            margin-bottom: 2px;
            color: #0f172a;
        }

        .timeline-date {
            font-size: 0.875rem;
            color: #64748b;
        }

        .dealer-tiers {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 16px;
            margin-top: 24px;
        }

        .tier-card {
            padding: 20px 16px;
            border-radius: 8px;
            text-align: center;
            color: white;
            font-weight: 600;
            border: 1px solid rgba(255,255,255,0.2);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .tier-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .tier-coif {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
        }

        .tier-deans {
            background: linear-gradient(135deg, #10b981, #059669);
        }

        .tier-honor {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
        }

        .tier-detention {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }

        .tier-count {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .tier-name {
            font-size: 0.875rem;
            opacity: 0.9;
        }

        .feature-list {
            list-style: none;
            margin-top: 20px;
        }

        .feature-list li {
            padding: 12px 0;
            border-bottom: 1px solid #f1f5f9;
            display: flex;
            align-items: center;
            color: #374151;
            transition: all 0.2s ease;
        }

        .feature-list li:hover {
            background: #f8fafc;
            padding-left: 8px;
            border-radius: 4px;
        }

        .feature-list li:last-child {
            border-bottom: none;
        }

        .feature-list i {
            margin-right: 12px;
            color: #3b82f6;
            width: 16px;
            text-align: center;
        }

        .feature-text {
            flex: 1;
            font-size: 0.875rem;
            color: #374151;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 4px;
            transition: background 0.2s ease;
        }

        .feature-text:hover {
            background: #f1f5f9;
        }

        .feature-delete {
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: background 0.2s ease;
            opacity: 0;
            visibility: hidden;
        }

        .feature-item:hover .feature-delete {
            opacity: 1;
            visibility: visible;
        }

        .feature-delete:hover {
            background: #dc2626;
        }

        .feature-item.editing {
            background: white;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .data-visualization {
            margin-top: 24px;
            padding: 24px;
            background: #f8fafc;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }

        .chart-container {
            height: 180px;
            background: white;
            border-radius: 8px;
            padding: 24px;
            margin-top: 20px;
            display: flex;
            align-items: end;
            justify-content: space-around;
            border: 1px solid #e2e8f0;
        }

        .chart-bar {
            width: 36px;
            background: #3b82f6;
            border-radius: 4px 4px 0 0;
            position: relative;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .chart-bar:hover {
            background: #2563eb;
            transform: scale(1.05);
        }

        .chart-label {
            position: absolute;
            bottom: -28px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.75rem;
            color: #64748b;
            font-weight: 500;
        }

        .chart-value {
            position: absolute;
            top: -28px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.75rem;
            font-weight: 600;
            color: #0f172a;
        }

        .section-title {
            font-size: 0.875rem;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        /* Todo List Styles */
        .todo-section {
            margin-top: 20px;
        }

        .todo-input-container {
            display: flex;
            margin-bottom: 16px;
            gap: 8px;
        }

        .todo-input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            font-size: 0.875rem;
            outline: none;
            transition: border-color 0.2s ease;
        }

        .todo-input:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .add-todo-btn {
            padding: 12px 16px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .add-todo-btn:hover {
            background: #2563eb;
        }

        .todo-list {
            list-style: none;
        }

        .todo-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            margin-bottom: 8px;
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            transition: all 0.2s ease;
        }

        .todo-item:hover {
            background: #f1f5f9;
        }

        .todo-item.completed {
            background: #dcfce7;
            border-color: #10b981;
        }

        .todo-item.editing {
            background: white;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .todo-input-inline {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #3b82f6;
            border-radius: 4px;
            font-size: 0.875rem;
            outline: none;
            background: white;
            margin: 0 8px;
        }

        .todo-input-inline:focus {
            border-color: #2563eb;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
        }

        .todo-checkbox {
            margin-right: 12px;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .todo-text {
            flex: 1;
            font-size: 0.875rem;
            color: #374151;
        }

        .todo-item.completed .todo-text {
            text-decoration: line-through;
            color: #6b7280;
        }

        .todo-delete {
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: background 0.2s ease;
            opacity: 0;
            visibility: hidden;
        }

        .todo-item:hover .todo-delete {
            opacity: 1;
            visibility: visible;
        }

        .todo-delete:hover {
            background: #dc2626;
        }

        .todo-text {
            flex: 1;
            font-size: 0.875rem;
            color: #374151;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 4px;
            transition: background 0.2s ease;
        }

        .todo-text:hover {
            background: #f1f5f9;
        }

        .todo-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid #e2e8f0;
            font-size: 0.875rem;
            color: #64748b;
        }

        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .metrics-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .container {
                padding: 20px 16px;
            }

            .card {
                padding: 24px;
            }

            .date-display {
                flex-direction: column;
                gap: 12px;
                text-align: center;
            }
        }

        /* Loading state styles */
        .container {
            transition: opacity 0.3s ease;
        }

        .loading-indicator {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.95);
            padding: 20px 40px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            display: none;
            align-items: center;
            gap: 12px;
            font-weight: 500;
            color: #3b82f6;
        }

        .loading-indicator.show {
            display: flex;
        }

        .loading-spinner {
            width: 20px;
            height: 20px;
            border: 2px solid #e2e8f0;
            border-top: 2px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Loading indicator -->
    <div class="loading-indicator" id="loading-indicator">
        <div class="loading-spinner"></div>
        <span>Loading Project Ralph...</span>
    </div>
    
    <div class="container">
        <div class="header">
            <h1>Project Ralph</h1>
            <button onclick="forceRefreshFromCloud()" style="position: absolute; top: 20px; right: 20px; background: #3b82f6; color: white; border: none; padding: 8px 16px; border-radius: 6px; font-size: 0.875rem; cursor: pointer; opacity: 0.7; transition: opacity 0.2s ease;" onmouseover="this.style.opacity='1'" onmouseout="this.style.opacity='0.7'" title="Force refresh from cloud">🔄 Refresh</button>
            <button onclick="debugCurrentState()" style="position: absolute; top: 20px; right: 120px; background: #10b981; color: white; border: none; padding: 8px 16px; border-radius: 6px; font-size: 0.875rem; cursor: pointer; opacity: 0.7; transition: opacity 0.2s ease;" onmouseover="this.style.opacity='1'" onmouseout="this.style.opacity='0.7'" title="Debug current state">🐛 Debug</button>
            <button onclick="createNewBinAndSync()" style="position: absolute; top: 20px; right: 220px; background: #f59e0b; color: white; border: none; padding: 8px 16px; border-radius: 6px; font-size: 0.875rem; cursor: pointer; opacity: 0.7; transition: opacity 0.2s ease;" onmouseover="this.style.opacity='1'" onmouseout="this.style.opacity='0.7'" title="Sync with live site">🔗 Sync</button>
            <button onclick="compareWithLiveSite()" style="position: absolute; top: 20px; right: 320px; background: #8b5cf6; color: white; border: none; padding: 8px 16px; border-radius: 6px; font-size: 0.875rem; cursor: pointer; opacity: 0.7; transition: opacity 0.2s ease;" onmouseover="this.style.opacity='1'" onmouseout="this.style.opacity='0.7'" title="Compare with live site">📊 Compare</button>
            <button onclick="updateCloudWithLiveData()" style="position: absolute; top: 20px; right: 420px; background: #ef4444; color: white; border: none; padding: 8px 16px; border-radius: 6px; font-size: 0.875rem; cursor: pointer; opacity: 0.7; transition: opacity 0.2s ease;" onmouseover="this.style.opacity='1'" onmouseout="this.style.opacity='0.7'" title="Update cloud with live data">☁️ Update Cloud</button>
        </div>

        <!-- Project Status Overview -->
        <div class="project-status-overview" style="background: white; border: 1px solid #e2e8f0; border-radius: 12px; padding: 24px; margin-bottom: 24px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <!-- Overall Progress Bar -->
            <div class="overall-progress-section" style="margin-bottom: 24px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                    <span style="font-weight: 600; color: #0f172a;">Overall Progress</span>
                    <span id="overall-progress-display" style="font-weight: 700; color: #3b82f6; font-size: 1.1rem;">25%</span>
                </div>
                <div style="width: 100%; height: 12px; background: #e2e8f0; border-radius: 6px; overflow: hidden;">
                    <div id="overall-progress-bar-display" style="height: 100%; background: linear-gradient(90deg, #3b82f6, #1d4ed8); border-radius: 6px; transition: width 0.3s ease; width: 25%;"></div>
                </div>
            </div>
            
            <!-- Project Timeline -->
            <div class="progress-timeline" style="margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                    <span style="font-weight: 600; color: #0f172a;">Timeline</span>
                    <span style="font-size: 0.875rem; color: #64748b;">Week 2 of 4</span>
                </div>
                <div style="position: relative; height: 8px; background: #e2e8f0; border-radius: 4px; overflow: hidden;">
                    <div style="position: absolute; top: 0; left: 0; height: 100%; background: linear-gradient(90deg, #10b981, #059669); border-radius: 4px; width: 25%;"></div>
                    <div style="position: absolute; top: 0; left: 25%; height: 100%; background: linear-gradient(90deg, #3b82f6, #2563eb); border-radius: 4px; width: 25%;"></div>
                    <div style="position: absolute; top: 0; left: 50%; height: 100%; background: #f1f5f9; border-radius: 4px; width: 25%;"></div>
                    <div style="position: absolute; top: 0; left: 75%; height: 100%; background: #f1f5f9; border-radius: 4px; width: 25%;"></div>
                    <!-- Current position indicator -->
                    <div style="position: absolute; top: -4px; left: 25%; width: 16px; height: 16px; background: #3b82f6; border: 3px solid white; border-radius: 50%; box-shadow: 0 2px 4px rgba(0,0,0,0.1);"></div>
                </div>
                <div style="display: flex; justify-content: space-between; margin-top: 8px; font-size: 0.75rem; color: #64748b;">
                    <span>Week 1</span>
                    <span>Week 2</span>
                    <span>Week 3</span>
                    <span>Week 4</span>
                </div>
            </div>
            
            <!-- Current Status -->
            <div class="current-status" style="display: flex; gap: 16px; flex-wrap: wrap;">
                <div style="flex: 1; min-width: 120px; padding: 12px; background: #f8fafc; border-radius: 8px; border: 1px solid #e2e8f0;">
                    <div style="font-size: 0.75rem; color: #64748b; margin-bottom: 4px;">INTERACTIONS</div>
                    <div style="font-weight: 600; color: #0f172a;"><span id="interaction-current-display" onclick="editInteractionCurrent(event)" style="cursor: pointer; padding: 2px 4px; border-radius: 3px; transition: background 0.2s ease;">500</span> / <span id="interaction-target-display" onclick="editInteractionTarget(event)" style="cursor: pointer; padding: 2px 4px; border-radius: 3px; transition: background 0.2s ease;">2,000</span></div>
                </div>
            </div>
        </div>

        <div class="date-display">
            <div class="current-date" id="current-date"></div>
            <div class="days-until-launch" id="days-until-launch"></div>
        </div>

        <div class="dashboard-grid">
            <!-- Todo List -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-tasks"></i>
                    </div>
                    <div class="card-title">Tasks</div>
                </div>
                <div class="todo-section">
                    <!-- Daily Tasks -->
                    <div class="task-category">
                        <h4 style="margin: 20px 0 12px 0; color: #0f172a; font-size: 1rem; font-weight: 600; border-bottom: 2px solid #3b82f6; padding-bottom: 4px;">Daily Tasks</h4>
                        <ul class="todo-list" id="daily-todo-list">
                            <li class="todo-item" data-type="daily">
                                <input type="checkbox" class="todo-checkbox" onchange="toggleTodo(this)" aria-label="Mark task as complete">
                                <span class="todo-text" onclick="editExistingTask(this)">Contact 10 new dealerships</span>
                                <button class="todo-delete" onclick="deleteTodo(this)" aria-label="Delete task">×</button>
                            </li>
                            <li class="todo-item" data-type="daily">
                                <input type="checkbox" class="todo-checkbox" onchange="toggleTodo(this)" aria-label="Mark task as complete">
                                <span class="todo-text" onclick="editExistingTask(this)">Review AI email responses</span>
                                <button class="todo-delete" onclick="deleteTodo(this)" aria-label="Delete task">×</button>
                            </li>
                        </ul>
                        <button class="add-task-btn" onclick="addNewTaskRow('daily')" style="background: #3b82f6; color: white; border: none; padding: 8px; border-radius: 50%; width: 32px; height: 32px; cursor: pointer; margin-top: 8px; display: flex; align-items: center; justify-content: center; font-size: 1rem;" aria-label="Add daily task">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    
                    <!-- Weekly Tasks -->
                    <div class="task-category">
                        <h4 style="margin: 20px 0 12px 0; color: #0f172a; font-size: 1rem; font-weight: 600; border-bottom: 2px solid #10b981; padding-bottom: 4px;">Weekly Tasks</h4>
                        <ul class="todo-list" id="weekly-todo-list">
                            <li class="todo-item" data-type="weekly">
                                <input type="checkbox" class="todo-checkbox" onchange="toggleTodo(this)" aria-label="Mark task as complete">
                                <span class="todo-text" onclick="editExistingTask(this)">Update progress metrics</span>
                                <button class="todo-delete" onclick="deleteTodo(this)" aria-label="Delete task">×</button>
                            </li>
                            <li class="todo-item" data-type="weekly">
                                <input type="checkbox" class="todo-checkbox" onchange="toggleTodo(this)" aria-label="Mark task as complete">
                                <span class="todo-text" onclick="editExistingTask(this)">Review dealer ratings</span>
                                <button class="todo-delete" onclick="deleteTodo(this)" aria-label="Delete task">×</button>
                            </li>
                        </ul>
                        <button class="add-task-btn" onclick="addNewTaskRow('weekly')" style="background: #10b981; color: white; border: none; padding: 8px; border-radius: 50%; width: 32px; height: 32px; cursor: pointer; margin-top: 8px; display: flex; align-items: center; justify-content: center; font-size: 1rem;" aria-label="Add weekly task">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    
                    <!-- Overall Tasks -->
                    <div class="task-category">
                        <h4 style="margin: 20px 0 12px 0; color: #0f172a; font-size: 1rem; font-weight: 600; border-bottom: 2px solid #f59e0b; padding-bottom: 4px;">Overall Tasks</h4>
                        <ul class="todo-list" id="overall-todo-list">
                            <li class="todo-item" data-type="overall">
                                <input type="checkbox" class="todo-checkbox" onchange="toggleTodo(this)" aria-label="Mark task as complete">
                                <span class="todo-text" onclick="editExistingTask(this)">Complete market analysis</span>
                                <button class="todo-delete" onclick="deleteTodo(this)" aria-label="Delete task">×</button>
                            </li>
                            <li class="todo-item" data-type="overall">
                                <input type="checkbox" class="todo-checkbox" onchange="toggleTodo(this)" aria-label="Mark task as complete">
                                <span class="todo-text" onclick="editExistingTask(this)">Launch product</span>
                                <button class="todo-delete" onclick="deleteTodo(this)" aria-label="Delete task">×</button>
                            </li>
                        </ul>
                        <button class="add-task-btn" onclick="addNewTaskRow('overall')" style="background: #f59e0b; color: white; border: none; padding: 8px; border-radius: 50%; width: 32px; height: 32px; cursor: pointer; margin-top: 8px; display: flex; align-items: center; justify-content: center; font-size: 1rem;" aria-label="Add overall task">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    
                    <div class="todo-stats">
                        <span id="todo-stats">6 tasks remaining</span>
                        <span id="todo-completed">0 completed</span>
                        <button onclick="clearAllTodos()" style="background: #ef4444; color: white; border: none; padding: 4px 8px; border-radius: 4px; font-size: 0.75rem; cursor: pointer;">Clear All</button>
                    </div>
                </div>
            </div>

            <!-- Dealer Rating Tiers -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-star"></i>
                    </div>
                    <div class="card-title">Dealer Rating Tiers</div>
                </div>
                <div class="tier-inputs" style="display: grid; gap: 16px; margin-bottom: 24px;">
                    <div class="tier-input-group" style="display: flex; align-items: center; gap: 12px; padding: 12px; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px;">
                        <div style="width: 16px; height: 16px; border-radius: 50%; background: linear-gradient(135deg, #fbbf24, #f59e0b); flex-shrink: 0;"></div>
                        <input type="text" class="tier-name-input" value="Order of the Coif" title="Edit tier name" placeholder="Enter tier name" style="flex: 1; border: none; background: transparent; font-weight: 600; color: #0f172a; font-size: 0.875rem; outline: none; padding: 4px 8px; border-radius: 4px; transition: background 0.2s ease;" onfocus="this.style.background='white'; this.style.boxShadow='0 0 0 2px rgba(59, 130, 246, 0.2)'" onblur="this.style.background='transparent'; this.style.boxShadow='none'; saveTierData(); updateDescriptionTitles()">
                        <span style="color: #64748b; font-size: 0.875rem;">Count:</span>
                        <input type="number" class="tier-count-input" value="0" min="0" title="Edit tier count" placeholder="0" style="width: 60px; border: 1px solid #e2e8f0; border-radius: 4px; padding: 4px 8px; text-align: center; font-size: 0.875rem; outline: none;" onchange="saveTierData()">
                    </div>
                    
                    <div class="tier-input-group" style="display: flex; align-items: center; gap: 12px; padding: 12px; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px;">
                        <div style="width: 16px; height: 16px; border-radius: 50%; background: linear-gradient(135deg, #10b981, #059669); flex-shrink: 0;"></div>
                        <input type="text" class="tier-name-input" value="Dean's List" title="Edit tier name" placeholder="Enter tier name" style="flex: 1; border: none; background: transparent; font-weight: 600; color: #0f172a; font-size: 0.875rem; outline: none; padding: 4px 8px; border-radius: 4px; transition: background 0.2s ease;" onfocus="this.style.background='white'; this.style.boxShadow='0 0 0 2px rgba(59, 130, 246, 0.2)'" onblur="this.style.background='transparent'; this.style.boxShadow='none'; saveTierData(); updateDescriptionTitles()">
                        <span style="color: #64748b; font-size: 0.875rem;">Count:</span>
                        <input type="number" class="tier-count-input" value="0" min="0" title="Edit tier count" placeholder="0" style="width: 60px; border: 1px solid #e2e8f0; border-radius: 4px; padding: 4px 8px; text-align: center; font-size: 0.875rem; outline: none;" onchange="saveTierData()">
                    </div>
                    
                    <div class="tier-input-group" style="display: flex; align-items: center; gap: 12px; padding: 12px; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px;">
                        <div style="width: 16px; height: 16px; border-radius: 50%; background: linear-gradient(135deg, #3b82f6, #2563eb); flex-shrink: 0;"></div>
                        <input type="text" class="tier-name-input" value="Honor Roll" title="Edit tier name" placeholder="Enter tier name" style="flex: 1; border: none; background: transparent; font-weight: 600; color: #0f172a; font-size: 0.875rem; outline: none; padding: 4px 8px; border-radius: 4px; transition: background 0.2s ease;" onfocus="this.style.background='white'; this.style.boxShadow='0 0 0 2px rgba(59, 130, 246, 0.2)'" onblur="this.style.background='transparent'; this.style.boxShadow='none'; saveTierData(); updateDescriptionTitles()">
                        <span style="color: #64748b; font-size: 0.875rem;">Count:</span>
                        <input type="number" class="tier-count-input" value="0" min="0" title="Edit tier count" placeholder="0" style="width: 60px; border: 1px solid #e2e8f0; border-radius: 4px; padding: 4px 8px; text-align: center; font-size: 0.875rem; outline: none;" onchange="saveTierData()">
                    </div>
                    
                    <div class="tier-input-group" style="display: flex; align-items: center; gap: 12px; padding: 12px; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px;">
                        <div style="width: 16px; height: 16px; border-radius: 50%; background: linear-gradient(135deg, #ef4444, #dc2626); flex-shrink: 0;"></div>
                        <input type="text" class="tier-name-input" value="Detention" title="Edit tier name" placeholder="Enter tier name" style="flex: 1; border: none; background: transparent; font-weight: 600; color: #0f172a; font-size: 0.875rem; outline: none; padding: 4px 8px; border-radius: 4px; transition: background 0.2s ease;" onfocus="this.style.background='white'; this.style.boxShadow='0 0 0 2px rgba(59, 130, 246, 0.2)'" onblur="this.style.background='transparent'; this.style.boxShadow='none'; saveTierData(); updateDescriptionTitles()">
                        <span style="color: #64748b; font-size: 0.875rem;">Count:</span>
                        <input type="number" class="tier-count-input" value="0" min="0" title="Edit tier count" placeholder="0" style="width: 60px; border: 1px solid #e2e8f0; border-radius: 4px; padding: 4px 8px; text-align: center; font-size: 0.875rem; outline: none;" onchange="saveTierData()">
                    </div>
                </div>
                
                <!-- Tier Descriptions -->
                <div class="tier-descriptions" style="margin-top: 24px;">
                    <h4 style="margin-bottom: 16px; color: #0f172a; font-size: 1rem; font-weight: 600;">Tier Descriptions</h4>
                    <div class="description-grid" style="display: grid; gap: 16px;">
                        <div class="description-item" style="border: 1px solid #e2e8f0; border-radius: 8px; padding: 16px; background: #f8fafc;">
                            <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                <div style="width: 16px; height: 16px; border-radius: 50%; background: linear-gradient(135deg, #fbbf24, #f59e0b); margin-right: 8px;"></div>
                                <strong style="color: #0f172a;">Order of the Coif</strong>
                            </div>
                            <textarea class="description-textarea" style="width: 100%; border: 1px solid #e2e8f0; border-radius: 4px; padding: 8px; font-size: 0.875rem; line-height: 1.4; color: #64748b; background: white; resize: none; height: 80px; outline: none; font-family: inherit;" onchange="saveTierData()" placeholder="Enter tier description...">Highest tier for dealers with exceptional transparency and customer service. These dealers consistently provide honest pricing, clear communication, and go above and beyond for their customers.</textarea>
                        </div>
                        
                        <div class="description-item" style="border: 1px solid #e2e8f0; border-radius: 8px; padding: 16px; background: #f8fafc;">
                            <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                <div style="width: 16px; height: 16px; border-radius: 50%; background: linear-gradient(135deg, #10b981, #059669); margin-right: 8px;"></div>
                                <strong style="color: #0f172a;">Dean's List</strong>
                            </div>
                            <textarea class="description-textarea" style="width: 100%; border: 1px solid #e2e8f0; border-radius: 4px; padding: 8px; font-size: 0.875rem; line-height: 1.4; color: #64748b; background: white; resize: none; height: 80px; outline: none; font-family: inherit;" onchange="saveTierData()" placeholder="Enter tier description...">High-performing dealers with good transparency practices. These dealers generally provide fair pricing and good customer service with minimal issues.</textarea>
                        </div>
                        
                        <div class="description-item" style="border: 1px solid #e2e8f0; border-radius: 8px; padding: 16px; background: #f8fafc;">
                            <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                <div style="width: 16px; height: 16px; border-radius: 50%; background: linear-gradient(135deg, #3b82f6, #2563eb); margin-right: 8px;"></div>
                                <strong style="color: #0f172a;">Honor Roll</strong>
                            </div>
                            <textarea class="description-textarea" style="width: 100%; border: 1px solid #e2e8f0; border-radius: 4px; padding: 8px; font-size: 0.875rem; line-height: 1.4; color: #64748b; background: white; resize: none; height: 80px; outline: none; font-family: inherit;" onchange="saveTierData()" placeholder="Enter tier description...">Average dealers with acceptable business practices. These dealers meet basic standards but may have occasional issues with transparency or customer service.</textarea>
                        </div>
                        
                        <div class="description-item" style="border: 1px solid #e2e8f0; border-radius: 8px; padding: 16px; background: #f8fafc;">
                            <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                <div style="width: 16px; height: 16px; border-radius: 50%; background: linear-gradient(135deg, #ef4444, #dc2626); margin-right: 8px;"></div>
                                <strong style="color: #0f172a;">Detention</strong>
                            </div>
                            <textarea class="description-textarea" style="width: 100%; border: 1px solid #e2e8f0; border-radius: 4px; padding: 8px; font-size: 0.875rem; line-height: 1.4; color: #64748b; background: white; resize: none; height: 80px; outline: none; font-family: inherit;" onchange="saveTierData()" placeholder="Enter tier description...">Dealers with poor transparency practices or customer service issues. These dealers may engage in deceptive practices, hidden fees, or provide poor customer experiences.</textarea>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Project Goals -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-bullseye"></i>
                    </div>
                    <div class="card-title">Project Goals</div>
                </div>
                <div style="margin-bottom: 20px; padding: 16px; background: #f0f9ff; border: 1px solid #bae6fd; border-radius: 8px;">
                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                        <i class="fas fa-info-circle" style="color: #0ea5e9; margin-right: 8px;"></i>
                        <span style="font-weight: 600; color: #0c4a6e;">Target Goals</span>
                    </div>
                    <p style="color: #0369a1; font-size: 0.875rem; margin: 0;">These are the targets we're working towards. Update the numbers to adjust your goals.</p>
                </div>
                <div class="metrics-grid">
                    <div class="metric" onclick="editDealershipCount()">
                        <div class="metric-value" id="dealership-count" onclick="editDealershipCount(event)">200</div>
                        <div class="metric-label">Target Dealerships</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="interaction-count">2,000</div>
                        <div class="metric-label">Target Interactions</div>
                    </div>
                    <div class="metric" onclick="updateMetric('weeks')">
                        <div class="metric-value">4</div>
                        <div class="metric-label">Project Weeks</div>
                    </div>
                    <div class="metric" onclick="updateMetric('launch')">
                        <div class="metric-value">Sep 1</div>
                        <div class="metric-label">Launch Date</div>
                    </div>
                </div>
            </div>







            <!-- Product Features -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-cogs"></i>
                    </div>
                    <div class="card-title">Product Features</div>
                </div>
                <ul class="feature-list" id="feature-list">
                    <li class="feature-item">
                        <i class="fas fa-headphones"></i>
                        <span class="feature-text" onclick="editFeature(this)">Live Earbud Support Device</span>
                        <button class="feature-delete" onclick="deleteFeature(this)" aria-label="Delete feature">×</button>
                    </li>
                    <li class="feature-item">
                        <i class="fas fa-comments"></i>
                        <span class="feature-text" onclick="editFeature(this)">Real-time AI Coaching</span>
                        <button class="feature-delete" onclick="deleteFeature(this)" aria-label="Delete feature">×</button>
                    </li>
                    <li class="feature-item">
                        <i class="fas fa-mobile-alt"></i>
                        <span class="feature-text" onclick="editFeature(this)">Mobile App Interface</span>
                        <button class="feature-delete" onclick="deleteFeature(this)" aria-label="Delete feature">×</button>
                    </li>
                    <li class="feature-item">
                        <i class="fas fa-chart-bar"></i>
                        <span class="feature-text" onclick="editFeature(this)">Quote Comparison Tools</span>
                        <button class="feature-delete" onclick="deleteFeature(this)" aria-label="Delete feature">×</button>
                    </li>
                    <li class="feature-item">
                        <i class="fas fa-file-contract"></i>
                        <span class="feature-text" onclick="editFeature(this)">Paperwork Walkthrough</span>
                        <button class="feature-delete" onclick="deleteFeature(this)" aria-label="Delete feature">×</button>
                    </li>
                    <li class="feature-item">
                        <i class="fas fa-shield-alt"></i>
                        <span class="feature-text" onclick="editFeature(this)">Dealer Transparency Ratings</span>
                        <button class="feature-delete" onclick="deleteFeature(this)" aria-label="Delete feature">×</button>
                    </li>
                </ul>
                <button class="add-feature-btn" onclick="addNewFeature()" style="background: #3b82f6; color: white; border: none; padding: 8px; border-radius: 50%; width: 32px; height: 32px; cursor: pointer; margin-top: 8px; display: flex; align-items: center; justify-content: center; font-size: 1rem;" aria-label="Add feature">
                    <i class="fas fa-plus"></i>
                </button>
            </div>


        </div>
    </div>

    <script>
        // Cloud storage configuration
        const JSONBIN_API_KEY = '$2a$10$SEnNfh62rZ5cbmvsRc5iGu5FElaadU.JCpjWywSTIWkdZWEWvt3.i';
        let JSONBIN_BIN_ID = localStorage.getItem('projectRalphBinId') || null;
        const JSONBIN_URL = 'https://api.jsonbin.io/v3/b';

        // Data structure for cloud storage
        let projectData = {
            interactions: {
                current: 500,
                target: 2000
            },
            dealerships: {
                current: 50,
                target: 200
            },
            todos: [],
            features: [],
            tierData: {
                names: {},
                counts: {},
                descriptions: {}
            },
            lastUpdated: new Date().toISOString()
        };

        // Show loading state
        function showLoadingState() {
            const loadingIndicator = document.getElementById('loading-indicator');
            const container = document.querySelector('.container');
            
            if (loadingIndicator) {
                loadingIndicator.classList.add('show');
            }
            if (container) {
                container.style.opacity = '0.7';
                container.style.transition = 'opacity 0.3s ease';
            }
        }

        // Hide loading state
        function hideLoadingState() {
            const loadingIndicator = document.getElementById('loading-indicator');
            const container = document.querySelector('.container');
            
            if (loadingIndicator) {
                loadingIndicator.classList.remove('show');
            }
            if (container) {
                container.style.opacity = '1';
            }
            
            // Show the page
            document.documentElement.classList.add('loaded');
        }

        // Save data to both localStorage and cloud
        async function saveDataToCloud() {
            try {
                // Update projectData with current values
                updateProjectDataFromDOM();
                
                // Save to localStorage as backup
                localStorage.setItem('projectRalphData', JSON.stringify(projectData));
                
                // Save to cloud if API key is configured
                if (JSONBIN_API_KEY !== 'YOUR_JSONBIN_API_KEY') {
                    let url = JSONBIN_URL;
                    let method = 'POST';
                    
                    // If we have a bin ID, update it; otherwise create a new one
                    if (JSONBIN_BIN_ID) {
                        url = `${JSONBIN_URL}/${JSONBIN_BIN_ID}`;
                        method = 'PUT';
                    }
                    
                    const response = await fetch(url, {
                        method: method,
                        headers: {
                            'Content-Type': 'application/json',
                            'X-Master-Key': JSONBIN_API_KEY
                        },
                        body: JSON.stringify(projectData)
                    });
                    
                    if (response.ok) {
                        const result = await response.json();
                        // If this was a new bin creation, save the bin ID
                        if (!JSONBIN_BIN_ID && result.metadata && result.metadata.id) {
                            JSONBIN_BIN_ID = result.metadata.id;
                            localStorage.setItem('projectRalphBinId', JSONBIN_BIN_ID);
                            console.log('New bin created with ID:', JSONBIN_BIN_ID);
                        }
                        console.log('Data saved to cloud successfully');
                    } else {
                        console.error('Failed to save to cloud:', response.statusText);
                    }
                }
            } catch (error) {
                console.error('Error saving data:', error);
            }
        }

        // Load data from cloud and localStorage with proper fallback
        async function loadDataFromCloud() {
            try {
                let data = null;
                
                // Try to load from cloud first for latest data
                if (JSONBIN_API_KEY !== 'YOUR_JSONBIN_API_KEY' && JSONBIN_BIN_ID) {
                    try {
                        console.log('Attempting to load from cloud...');
                        console.log('JSONBIN_BIN_ID:', JSONBIN_BIN_ID);
                        
                        const response = await fetch(`${JSONBIN_URL}/${JSONBIN_BIN_ID}/latest`, {
                            headers: {
                                'X-Master-Key': JSONBIN_API_KEY
                            }
                        });
                        
                        console.log('Cloud response status:', response.status);
                        
                        if (response.ok) {
                            const result = await response.json();
                            console.log('Cloud response data:', result);
                            
                            const cloudData = result.record;
                            
                            if (cloudData) {
                                console.log('Cloud data found, applying to DOM...');
                                console.log('Cloud data details:', {
                                    interactions: cloudData.interactions,
                                    dealerships: cloudData.dealerships,
                                    todos: cloudData.todos,
                                    features: cloudData.features,
                                    lastUpdated: cloudData.lastUpdated
                                });
                                
                                projectData = cloudData;
                                applyProjectDataToDOM();
                                localStorage.setItem('projectRalphData', JSON.stringify(cloudData));
                                console.log('Data loaded from cloud successfully');
                                return; // Exit early since we got cloud data
                            } else {
                                console.log('No cloud data found in response');
                            }
                        } else {
                            console.log('Cloud response not OK:', response.statusText);
                        }
                    } catch (error) {
                        console.log('Could not load from cloud, trying localStorage:', error);
                    }
                } else {
                    console.log('Cloud loading skipped - API key or bin ID missing');
                    console.log('JSONBIN_API_KEY check:', JSONBIN_API_KEY !== 'YOUR_JSONBIN_API_KEY');
                    console.log('JSONBIN_BIN_ID:', JSONBIN_BIN_ID);
                }
                
                // Fallback to localStorage if cloud load failed
                const localData = localStorage.getItem('projectRalphData');
                if (localData) {
                    try {
                        data = JSON.parse(localData);
                        projectData = data;
                        applyProjectDataToDOM();
                        console.log('Data loaded from localStorage');
                    } catch (error) {
                        console.error('Error parsing localStorage data:', error);
                    }
                } else {
                    console.log('No local data found');
                }
                
            } catch (error) {
                console.error('Error loading data:', error);
            }
        }

        // Update projectData object from current DOM values
        function updateProjectDataFromDOM() {
            // Update interactions
            const interactionCurrent = document.getElementById('interaction-current-display');
            const interactionTarget = document.getElementById('interaction-target-display');
            if (interactionCurrent && interactionTarget) {
                projectData.interactions.current = parseInt(interactionCurrent.textContent);
                projectData.interactions.target = parseInt(interactionTarget.textContent.replace(',', ''));
            }
            
            // Update dealerships
            const dealershipCurrent = localStorage.getItem('dealershipProgress') || '50';
            const dealershipTarget = localStorage.getItem('dealershipCount') || '200';
            projectData.dealerships.current = parseInt(dealershipCurrent);
            projectData.dealerships.target = parseInt(dealershipTarget);
            
            // Update todos
            const todoItems = document.querySelectorAll('.todo-item');
            projectData.todos = [];
            todoItems.forEach(item => {
                const checkbox = item.querySelector('.todo-checkbox');
                const text = item.querySelector('.todo-text');
                const type = item.getAttribute('data-type') || 'daily';
                if (text) {
                    projectData.todos.push({
                        text: text.textContent,
                        completed: checkbox ? checkbox.checked : false,
                        type: type
                    });
                }
            });
            
            // Update features
            const featureItems = document.querySelectorAll('.feature-item');
            projectData.features = [];
            featureItems.forEach(item => {
                const text = item.querySelector('.feature-text');
                if (text) {
                    projectData.features.push(text.textContent);
                }
            });
            
            // Update tier data
            const tierNameInputs = document.querySelectorAll('.tier-name-input');
            const tierCountInputs = document.querySelectorAll('.tier-count-input');
            const descriptions = document.querySelectorAll('.description-textarea');
            
            projectData.tierData.names = {};
            projectData.tierData.counts = {};
            projectData.tierData.descriptions = {};
            
            tierNameInputs.forEach((nameInput, index) => {
                projectData.tierData.names[`tier${index}`] = nameInput.value;
                projectData.tierData.counts[`tier${index}`] = tierCountInputs[index].value;
                projectData.tierData.descriptions[`tier${index}`] = descriptions[index].value;
            });
            
            projectData.lastUpdated = new Date().toISOString();
        }

        // Apply projectData to DOM
        function applyProjectDataToDOM() {
            console.log('=== APPLYING PROJECT DATA TO DOM ===');
            console.log('projectData to apply:', projectData);
            
            // Apply interactions
            if (projectData.interactions) {
                console.log('Applying interactions:', projectData.interactions);
                const currentElement = document.getElementById('interaction-current-display');
                const targetElement = document.getElementById('interaction-target-display');
                
                if (currentElement) {
                    currentElement.textContent = projectData.interactions.current;
                    console.log('Set interaction-current-display to:', projectData.interactions.current);
                }
                if (targetElement) {
                    targetElement.textContent = projectData.interactions.target.toLocaleString();
                    console.log('Set interaction-target-display to:', projectData.interactions.target.toLocaleString());
                }
                
                localStorage.setItem('interactionProgress', projectData.interactions.current.toString());
                localStorage.setItem('interactionCount', projectData.interactions.target.toString());
            }
            
            // Apply dealerships
            if (projectData.dealerships) {
                console.log('Applying dealerships:', projectData.dealerships);
                localStorage.setItem('dealershipProgress', projectData.dealerships.current.toString());
                localStorage.setItem('dealershipCount', projectData.dealerships.target.toString());
                
                // Also update the dealership count display
                const dealershipElement = document.getElementById('dealership-count');
                if (dealershipElement) {
                    dealershipElement.textContent = projectData.dealerships.target;
                    console.log('Set dealership-count to:', projectData.dealerships.target);
                }
            }
            
            // Apply todos
            if (projectData.todos && projectData.todos.length > 0) {
                // Clear existing todos
                document.getElementById('daily-todo-list').innerHTML = '';
                document.getElementById('weekly-todo-list').innerHTML = '';
                document.getElementById('overall-todo-list').innerHTML = '';
                
                // Add todos from data
                projectData.todos.forEach(todo => {
                    const li = document.createElement('li');
                    li.className = 'todo-item';
                    li.setAttribute('data-type', todo.type || 'daily');
                    if (todo.completed) {
                        li.classList.add('completed');
                    }
                    
                    li.innerHTML = `
                        <input type="checkbox" class="todo-checkbox" onchange="toggleTodo(this)" ${todo.completed ? 'checked' : ''} aria-label="Mark task as complete">
                        <span class="todo-text" onclick="editExistingTask(this)">${todo.text}</span>
                        <button class="todo-delete" onclick="deleteTodo(this)" aria-label="Delete task">×</button>
                    `;
                    
                    const targetList = document.getElementById(`${todo.type || 'daily'}-todo-list`);
                    if (targetList) {
                        targetList.appendChild(li);
                    }
                });
                
                updateTodoStats();
            }
            
            // Apply features
            if (projectData.features && projectData.features.length > 0) {
                const featureList = document.getElementById('feature-list');
                featureList.innerHTML = '';
                
                projectData.features.forEach(feature => {
                    const li = document.createElement('li');
                    li.className = 'feature-item';
                    li.innerHTML = `
                        <i class="fas fa-cog"></i>
                        <span class="feature-text" onclick="editFeature(this)">${feature}</span>
                        <button class="feature-delete" onclick="deleteFeature(this)" aria-label="Delete feature">×</button>
                    `;
                    featureList.appendChild(li);
                });
            }
            
            // Apply tier data
            if (projectData.tierData) {
                const tierNameInputs = document.querySelectorAll('.tier-name-input');
                const tierCountInputs = document.querySelectorAll('.tier-count-input');
                const descriptions = document.querySelectorAll('.description-textarea');
                
                tierNameInputs.forEach((nameInput, index) => {
                    if (projectData.tierData.names[`tier${index}`]) {
                        nameInput.value = projectData.tierData.names[`tier${index}`];
                    }
                    if (projectData.tierData.counts[`tier${index}`]) {
                        tierCountInputs[index].value = projectData.tierData.counts[`tier${index}`];
                    }
                    if (projectData.tierData.descriptions[`tier${index}`]) {
                        descriptions[index].value = projectData.tierData.descriptions[`tier${index}`];
                    }
                });
                
                updateDescriptionTitles();
            }
            
            // Update progress displays
            updateProgress();
        }

        // Initialize date display
        function updateDateDisplay() {
            const today = new Date();
            const launchDate = new Date('2025-09-01');
            const daysUntilLaunch = Math.ceil((launchDate - today) / (1000 * 60 * 60 * 24));
            
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('current-date').textContent = today.toLocaleDateString('en-US', options);
            document.getElementById('days-until-launch').textContent = `${daysUntilLaunch} days until launch`;
        }

        // Interactive functionality
        function updateProgress() {
            // Get current values from localStorage or use defaults
            const dealershipProgress = parseInt(localStorage.getItem('dealershipProgress') || '50');
            const interactionProgress = parseInt(localStorage.getItem('interactionProgress') || '500');
            
            // Get target values from current display or localStorage
            const dealershipTarget = parseInt(localStorage.getItem('dealershipCount') || '200');
            const interactionTarget = parseInt(localStorage.getItem('interactionCount') || '2000');
            
            // Update Data Collection section (only if elements exist)
            const dealershipProgressElement = document.getElementById('dealership-progress');
            const dealershipProgressBarElement = document.getElementById('dealership-progress-bar');
            const interactionProgressElement = document.getElementById('interaction-progress');
            const interactionProgressBarElement = document.getElementById('interaction-progress-bar');
            
            if (dealershipProgressElement) {
                dealershipProgressElement.textContent = `${dealershipProgress}/${dealershipTarget}`;
            }
            if (dealershipProgressBarElement) {
                dealershipProgressBarElement.style.width = `${(dealershipProgress/dealershipTarget)*100}%`;
            }
            if (interactionProgressElement) {
                interactionProgressElement.textContent = `${interactionProgress}/${interactionTarget.toLocaleString()}`;
            }
            if (interactionProgressBarElement) {
                interactionProgressBarElement.style.width = `${(interactionProgress/interactionTarget)*100}%`;
            }
            
            // Update overall progress
            updateOverallProgress();
            
            // Update current status display
            const interactionCurrentDisplay = document.getElementById('interaction-current-display');
            const interactionTargetDisplay = document.getElementById('interaction-target-display');
            
            if (interactionCurrentDisplay) {
                interactionCurrentDisplay.textContent = interactionProgress;
            }
            if (interactionTargetDisplay) {
                interactionTargetDisplay.textContent = interactionTarget.toLocaleString();
            }
        }

        // Update overall progress bar based on interactions
        function updateOverallProgress() {
            const interactionProgress = parseInt(localStorage.getItem('interactionProgress') || '500');
            const interactionTarget = parseInt(localStorage.getItem('interactionCount') || '2000');
            
            // Calculate overall progress based on interactions
            const overallProgress = Math.round((interactionProgress/interactionTarget) * 100);
            document.getElementById('overall-progress-display').textContent = `${overallProgress}%`;
            document.getElementById('overall-progress-bar-display').style.width = `${overallProgress}%`;
        }

        // Edit progress values
        function editProgress(type) {
            const currentValue = type === 'dealership' ? 
                parseInt(localStorage.getItem('dealershipProgress') || '50') :
                parseInt(localStorage.getItem('interactionProgress') || '500');
            
            const maxValue = type === 'dealership' ? 200 : 2000;
            const newValue = prompt(`Enter new ${type} progress (0-${maxValue}):`, currentValue);
            
            if (newValue !== null && !isNaN(newValue)) {
                const numValue = parseInt(newValue);
                if (numValue >= 0 && numValue <= maxValue) {
                    if (type === 'dealership') {
                        localStorage.setItem('dealershipProgress', numValue.toString());
                    } else {
                        localStorage.setItem('interactionProgress', numValue.toString());
                    }
                    updateProgress();
                    saveDataToCloud(); // Save to cloud
                } else {
                    alert(`Please enter a number between 0 and ${maxValue}`);
                }
            }
        }

        // Interactive metric updates
        function updateMetric(type) {
            const metricElement = document.getElementById(`${type}-count`);
            if (type === 'dealerships') {
                const current = parseInt(metricElement.textContent);
                metricElement.textContent = current + Math.floor(Math.random() * 5) + 1;
            } else if (type === 'interactions') {
                const current = parseInt(metricElement.textContent.replace(',', ''));
                metricElement.textContent = (current + Math.floor(Math.random() * 50) + 10).toLocaleString();
            }
        }

        // Edit dealership count
        function editDealershipCount(event) {
            if (event) {
                event.stopPropagation(); // Prevent triggering the parent onclick
            }
            
            const dealershipElement = document.getElementById('dealership-count');
            const currentValue = dealershipElement.textContent;
            
            // Convert to editing mode
            dealershipElement.classList.add('editing');
            dealershipElement.innerHTML = `<input type="number" class="metric-input" value="${currentValue}" onkeypress="handleDealershipKeyPress(event, this)" onblur="saveDealershipCount(this)" min="1" max="9999">`;
            
            // Focus and select all text
            const input = dealershipElement.querySelector('.metric-input');
            input.focus();
            input.select();
        }

        function handleDealershipKeyPress(event, input) {
            if (event.key === 'Enter') {
                saveDealershipCount(input);
            } else if (event.key === 'Escape') {
                cancelDealershipEdit(input);
            }
        }

        function saveDealershipCount(input) {
            const newValue = parseInt(input.value);
            const dealershipElement = document.getElementById('dealership-count');
            
            if (newValue && newValue > 0 && newValue <= 9999) {
                // Save dealership count
                dealershipElement.textContent = newValue;
                dealershipElement.classList.remove('editing');
                
                // Update interactions (10x dealership count)
                const interactionElement = document.getElementById('interaction-count');
                interactionElement.textContent = (newValue * 10).toLocaleString();
                
                // Update progress calculations
                updateProgress();
                
                // Save to localStorage
                localStorage.setItem('dealershipCount', newValue.toString());
                localStorage.setItem('interactionCount', (newValue * 10).toString());
                
                // Update top progress display targets
                document.getElementById('dealership-target-display').textContent = newValue;
                document.getElementById('interaction-target-display').textContent = (newValue * 10).toLocaleString();
                
                saveDataToCloud(); // Save to cloud
            } else {
                // Invalid value, revert to original
                cancelDealershipEdit(input);
            }
        }

        function cancelDealershipEdit(input) {
            const dealershipElement = document.getElementById('dealership-count');
            const savedValue = localStorage.getItem('dealershipCount') || '200';
            dealershipElement.textContent = savedValue;
            dealershipElement.classList.remove('editing');
        }

        // Edit top progress numbers
        function editInteractionCurrent(event) {
            event.stopPropagation();
            const element = document.getElementById('interaction-current-display');
            const currentValue = element.textContent;
            
            element.innerHTML = `<input type="number" value="${currentValue}" onkeypress="handleTopNumberKeyPress(event, this, 'interaction-current')" onblur="saveTopNumber(this, 'interaction-current')" min="0" max="99999" style="width: 60px; border: 1px solid #3b82f6; border-radius: 3px; padding: 2px 4px; font-size: inherit; font-weight: inherit;">`;
            
            const input = element.querySelector('input');
            input.focus();
            input.select();
        }

        function editInteractionTarget(event) {
            event.stopPropagation();
            const element = document.getElementById('interaction-target-display');
            const currentValue = element.textContent.replace(',', '');
            
            element.innerHTML = `<input type="number" value="${currentValue}" onkeypress="handleTopNumberKeyPress(event, this, 'interaction-target')" onblur="saveTopNumber(this, 'interaction-target')" min="1" max="99999" style="width: 60px; border: 1px solid #3b82f6; border-radius: 3px; padding: 2px 4px; font-size: inherit; font-weight: inherit;">`;
            
            const input = element.querySelector('input');
            input.focus();
            input.select();
        }

        function handleTopNumberKeyPress(event, input, type) {
            if (event.key === 'Enter') {
                saveTopNumber(input, type);
            } else if (event.key === 'Escape') {
                cancelTopNumberEdit(input, type);
            }
        }

        function saveTopNumber(input, type) {
            const newValue = parseInt(input.value);
            const element = input.parentElement;
            
            if (newValue >= 0 && newValue <= 99999) {
                if (type === 'interaction-current') {
                    element.textContent = newValue;
                    localStorage.setItem('interactionProgress', newValue.toString());
                } else if (type === 'interaction-target') {
                    element.textContent = newValue.toLocaleString();
                    localStorage.setItem('interactionCount', newValue.toString());
                }
                
                // Immediately update overall progress calculation
                updateOverallProgress();
                
                // Save to cloud
                saveDataToCloud();
            } else {
                cancelTopNumberEdit(input, type);
            }
        }

        function cancelTopNumberEdit(input, type) {
            const element = input.parentElement;
            if (type === 'interaction-current') {
                const savedValue = localStorage.getItem('interactionProgress') || '500';
                element.textContent = savedValue;
            } else if (type === 'interaction-target') {
                const savedValue = localStorage.getItem('interactionCount') || '2000';
                element.textContent = parseInt(savedValue).toLocaleString();
            }
        }

        // Update description titles when tier names change
        function updateDescriptionTitles() {
            const descriptionItems = document.querySelectorAll('.description-item');
            const tierNameInputs = document.querySelectorAll('.tier-name-input');
            descriptionItems.forEach((item, index) => {
                const title = item.querySelector('strong');
                if (tierNameInputs[index]) {
                    title.textContent = tierNameInputs[index].value;
                }
            });
        }

        // Save tier data to localStorage and cloud
        function saveTierData() {
            const tierData = {
                names: {},
                counts: {},
                descriptions: {}
            };
            
            // Save tier names and counts
            const tierNameInputs = document.querySelectorAll('.tier-name-input');
            const tierCountInputs = document.querySelectorAll('.tier-count-input');
            tierNameInputs.forEach((nameInput, index) => {
                tierData.names[`tier${index}`] = nameInput.value;
                tierData.counts[`tier${index}`] = tierCountInputs[index].value;
            });
            
            // Save descriptions
            const descriptions = document.querySelectorAll('.description-textarea');
            descriptions.forEach((desc, index) => {
                tierData.descriptions[`tier${index}`] = desc.value;
            });
            
            // Update description titles
            updateDescriptionTitles();
            
            localStorage.setItem('projectRalphTierData', JSON.stringify(tierData));
            saveDataToCloud(); // Save to cloud
        }

        // Load tier data from localStorage and cloud
        function loadTierData() {
            const savedData = localStorage.getItem('projectRalphTierData');
            if (savedData) {
                const tierData = JSON.parse(savedData);
                
                // Load tier names and counts
                const tierNameInputs = document.querySelectorAll('.tier-name-input');
                const tierCountInputs = document.querySelectorAll('.tier-count-input');
                tierNameInputs.forEach((nameInput, index) => {
                    if (tierData.names[`tier${index}`]) {
                        nameInput.value = tierData.names[`tier${index}`];
                    }
                    if (tierData.counts[`tier${index}`]) {
                        tierCountInputs[index].value = tierData.counts[`tier${index}`];
                    }
                });
                
                // Load descriptions
                const descriptions = document.querySelectorAll('.description-textarea');
                descriptions.forEach((desc, index) => {
                    if (tierData.descriptions[`tier${index}`]) {
                        desc.value = tierData.descriptions[`tier${index}`];
                    }
                });
                
                // Update description titles to match tier names
                const descriptionItems = document.querySelectorAll('.description-item');
                const tierNameInputsForTitles = document.querySelectorAll('.tier-name-input');
                descriptionItems.forEach((item, index) => {
                    const title = item.querySelector('strong');
                    if (tierNameInputsForTitles[index]) {
                        title.textContent = tierNameInputsForTitles[index].value;
                    }
                });
            }
        }

        // Todo list functionality
        function addNewTaskRow(taskType) {
            const todoList = document.getElementById(`${taskType}-todo-list`);
            const li = document.createElement('li');
            li.className = 'todo-item editing';
            li.setAttribute('data-type', taskType);
            li.innerHTML = `
                <input type="checkbox" class="todo-checkbox" onchange="toggleTodo(this)" aria-label="Mark task as complete" disabled>
                <input type="text" class="todo-input-inline" placeholder="Type your task here..." onkeypress="handleInlineKeyPress(event, this)" onblur="saveInlineTask(this)" style="flex: 1; padding: 8px 12px; border: 1px solid #3b82f6; border-radius: 4px; font-size: 0.875rem; outline: none; background: white;">
                <button class="todo-delete" onclick="deleteTodo(this)" aria-label="Delete task">×</button>
            `;
            todoList.appendChild(li);
            
            // Focus on the input
            const input = li.querySelector('.todo-input-inline');
            input.focus();
        }

        function handleInlineKeyPress(event, input) {
            if (event.key === 'Enter') {
                saveInlineTask(input);
            } else if (event.key === 'Escape') {
                cancelInlineTask(input);
            }
        }

        function saveInlineTask(input) {
            const text = input.value.trim();
            const todoItem = input.closest('.todo-item');
            
            if (text) {
                // Convert to regular task item
                todoItem.classList.remove('editing');
                todoItem.innerHTML = `
                    <input type="checkbox" class="todo-checkbox" onchange="toggleTodo(this)" aria-label="Mark task as complete">
                    <span class="todo-text" onclick="editExistingTask(this)">${text}</span>
                    <button class="todo-delete" onclick="deleteTodo(this)" aria-label="Delete task">×</button>
                `;
                updateTodoStats();
                saveTodos();
                saveDataToCloud(); // Save to cloud
            } else {
                // Remove empty task
                todoItem.remove();
            }
        }

        function editExistingTask(element) {
            const currentText = element.textContent;
            const todoItem = element.closest('.todo-item');
            
            // Convert to editing mode
            todoItem.classList.add('editing');
            todoItem.innerHTML = `
                <input type="checkbox" class="todo-checkbox" onchange="toggleTodo(this)" aria-label="Mark task as complete" disabled>
                <input type="text" class="todo-input-inline" value="${currentText}" onkeypress="handleInlineKeyPress(event, this)" onblur="saveInlineTask(this)" style="flex: 1; padding: 8px 12px; border: 1px solid #3b82f6; border-radius: 4px; font-size: 0.875rem; outline: none; background: white;">
                <button class="todo-delete" onclick="deleteTodo(this)" aria-label="Delete task">×</button>
            `;
            
            // Focus and select all text
            const input = todoItem.querySelector('.todo-input-inline');
            input.focus();
            input.select();
        }

        function cancelInlineTask(input) {
            const todoItem = input.closest('.todo-item');
            todoItem.remove();
        }

        function toggleTodo(checkbox) {
            const todoItem = checkbox.parentElement;
            if (checkbox.checked) {
                todoItem.classList.add('completed');
            } else {
                todoItem.classList.remove('completed');
            }
            updateTodoStats();
            saveTodos();
            saveDataToCloud(); // Save to cloud
        }

        function deleteTodo(button) {
            button.parentElement.remove();
            updateTodoStats();
            saveTodos();
            saveDataToCloud(); // Save to cloud
        }

        function updateTodoStats() {
            const todoItems = document.querySelectorAll('.todo-item');
            const completedItems = document.querySelectorAll('.todo-item.completed');
            const remaining = todoItems.length - completedItems.length;
            
            document.getElementById('todo-stats').textContent = `${remaining} tasks remaining`;
            document.getElementById('todo-completed').textContent = `${completedItems.length} completed`;
        }

        // Save todos to localStorage and cloud
        function saveTodos() {
            const todoItems = document.querySelectorAll('.todo-item');
            const todos = [];
            
            todoItems.forEach(item => {
                const checkbox = item.querySelector('.todo-checkbox');
                const text = item.querySelector('.todo-text').textContent;
                const type = item.getAttribute('data-type') || 'daily';
                todos.push({
                    text: text,
                    completed: checkbox.checked,
                    type: type
                });
            });
            
            localStorage.setItem('projectRalphTodos', JSON.stringify(todos));
        }

        // Load todos from localStorage and cloud
        function loadTodos() {
            const savedTodos = localStorage.getItem('projectRalphTodos');
            if (savedTodos) {
                const todos = JSON.parse(savedTodos);
                
                // Clear existing todos from all lists
                document.getElementById('daily-todo-list').innerHTML = '';
                document.getElementById('weekly-todo-list').innerHTML = '';
                document.getElementById('overall-todo-list').innerHTML = '';
                
                todos.forEach(todo => {
                    const li = document.createElement('li');
                    li.className = 'todo-item';
                    li.setAttribute('data-type', todo.type || 'daily');
                    if (todo.completed) {
                        li.classList.add('completed');
                    }
                    
                    li.innerHTML = `
                        <input type="checkbox" class="todo-checkbox" onchange="toggleTodo(this)" ${todo.completed ? 'checked' : ''} aria-label="Mark task as complete">
                        <span class="todo-text" onclick="editExistingTask(this)">${todo.text}</span>
                        <button class="todo-delete" onclick="deleteTodo(this)" aria-label="Delete task">×</button>
                    `;
                    
                    const targetList = document.getElementById(`${todo.type || 'daily'}-todo-list`);
                    if (targetList) {
                        targetList.appendChild(li);
                    }
                });
                
                updateTodoStats();
            }
        }

        // Clear all todos (for testing)
        function clearAllTodos() {
            if (confirm('Are you sure you want to clear all tasks?')) {
                localStorage.removeItem('projectRalphTodos');
                document.getElementById('daily-todo-list').innerHTML = '';
                document.getElementById('weekly-todo-list').innerHTML = '';
                document.getElementById('overall-todo-list').innerHTML = '';
                updateTodoStats();
                saveDataToCloud(); // Save to cloud
            }
        }

        // Force refresh from cloud (for debugging)
        function forceRefreshFromCloud() {
            if (confirm('This will clear local cache and reload from cloud. Continue?')) {
                // Clear all localStorage data
                localStorage.removeItem('projectRalphData');
                localStorage.removeItem('projectRalphTodos');
                localStorage.removeItem('projectRalphTierData');
                localStorage.removeItem('projectRalphFeatures');
                localStorage.removeItem('interactionProgress');
                localStorage.removeItem('interactionCount');
                localStorage.removeItem('dealershipProgress');
                localStorage.removeItem('dealershipCount');
                
                // Reload the page
                location.reload();
            }
        }

        // Debug function to check current state
        function debugCurrentState() {
            console.log('=== DEBUG CURRENT STATE ===');
            console.log('JSONBIN_BIN_ID:', JSONBIN_BIN_ID);
            console.log('projectData:', projectData);
            
            const localData = localStorage.getItem('projectRalphData');
            console.log('localStorage projectRalphData:', localData ? JSON.parse(localData) : 'null');
            
            console.log('Current DOM values:');
            console.log('interaction-current-display:', document.getElementById('interaction-current-display')?.textContent);
            console.log('interaction-target-display:', document.getElementById('interaction-target-display')?.textContent);
            console.log('dealership-count:', document.getElementById('dealership-count')?.textContent);
            console.log('interaction-count:', document.getElementById('interaction-count')?.textContent);
            
            console.log('localStorage values:');
            console.log('interactionProgress:', localStorage.getItem('interactionProgress'));
            console.log('interactionCount:', localStorage.getItem('interactionCount'));
            console.log('dealershipProgress:', localStorage.getItem('dealershipProgress'));
            console.log('dealershipCount:', localStorage.getItem('dealershipCount'));
            console.log('=== END DEBUG ===');
        }

        // Function to get bin ID from live site
        async function getBinIdFromLiveSite() {
            try {
                console.log('Attempting to get bin ID from live site...');
                const response = await fetch('https://bennymorton28.github.io/Project-Ralph/');
                const html = await response.text();
                
                // Look for the bin ID in the HTML
                const binIdMatch = html.match(/JSONBIN_BIN_ID.*?localStorage\.getItem\('projectRalphBinId'\) \|\| '([^']+)'/);
                if (binIdMatch && binIdMatch[1]) {
                    const liveBinId = binIdMatch[1];
                    console.log('Found bin ID from live site:', liveBinId);
                    return liveBinId;
                }
                
                console.log('Could not find bin ID in live site HTML');
                return null;
            } catch (error) {
                console.error('Error getting bin ID from live site:', error);
                return null;
            }
        }

        // Function to create a new bin and sync with live data
        async function createNewBinAndSync() {
            try {
                console.log('Creating new bin and syncing with live data...');
                
                // First, try to get the bin ID from the live site
                const liveBinId = await getBinIdFromLiveSite();
                
                if (liveBinId) {
                    // Use the live site's bin ID
                    JSONBIN_BIN_ID = liveBinId;
                    localStorage.setItem('projectRalphBinId', liveBinId);
                    console.log('Using bin ID from live site:', liveBinId);
                } else {
                    // Create a new bin
                    console.log('Creating new bin...');
                    const response = await fetch(JSONBIN_URL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-Master-Key': JSONBIN_API_KEY
                        },
                        body: JSON.stringify(projectData)
                    });
                    
                    if (response.ok) {
                        const result = await response.json();
                        JSONBIN_BIN_ID = result.metadata.id;
                        localStorage.setItem('projectRalphBinId', JSONBIN_BIN_ID);
                        console.log('Created new bin with ID:', JSONBIN_BIN_ID);
                    } else {
                        console.error('Failed to create new bin');
                        return false;
                    }
                }
                
                // Now load the data from the cloud
                await loadDataFromCloud();
                return true;
            } catch (error) {
                console.error('Error creating new bin:', error);
                return false;
            }
        }

        // Function to compare live site data with local data
        async function compareWithLiveSite() {
            try {
                console.log('=== COMPARING WITH LIVE SITE ===');
                
                // Get the live site's HTML
                const response = await fetch('https://bennymorton28.github.io/Project-Ralph/');
                const html = await response.text();
                
                // Extract values from the live site HTML
                const interactionCurrentMatch = html.match(/interaction-current-display.*?(\d+)/);
                const interactionTargetMatch = html.match(/interaction-target-display.*?(\d{1,3}(?:,\d{3})*)/);
                const dealershipCountMatch = html.match(/dealership-count.*?(\d+)/);
                
                console.log('Live site values:');
                console.log('interaction-current:', interactionCurrentMatch ? interactionCurrentMatch[1] : 'not found');
                console.log('interaction-target:', interactionTargetMatch ? interactionTargetMatch[1] : 'not found');
                console.log('dealership-count:', dealershipCountMatch ? dealershipCountMatch[1] : 'not found');
                
                console.log('Local values:');
                console.log('interaction-current:', document.getElementById('interaction-current-display')?.textContent);
                console.log('interaction-target:', document.getElementById('interaction-target-display')?.textContent);
                console.log('dealership-count:', document.getElementById('dealership-count')?.textContent);
                
                console.log('=== END COMPARISON ===');
                
                // Return the live site values for potential use
                return {
                    interactionCurrent: interactionCurrentMatch ? parseInt(interactionCurrentMatch[1]) : null,
                    interactionTarget: interactionTargetMatch ? parseInt(interactionTargetMatch[1].replace(/,/g, '')) : null,
                    dealershipCount: dealershipCountMatch ? parseInt(dealershipCountMatch[1]) : null
                };
            } catch (error) {
                console.error('Error comparing with live site:', error);
                return null;
            }
        }

        // Function to update cloud with live site data
        async function updateCloudWithLiveData() {
            try {
                console.log('=== UPDATING CLOUD WITH LIVE DATA ===');
                
                // Get the live site data
                const liveData = await compareWithLiveSite();
                
                if (liveData) {
                    // Create updated project data with live site values
                    const updatedProjectData = {
                        interactions: {
                            current: liveData.interactionCurrent || 500,
                            target: liveData.interactionTarget || 2000
                        },
                        dealerships: {
                            current: 50, // Default value
                            target: liveData.dealershipCount || 200
                        },
                        todos: [],
                        features: [],
                        tierData: {
                            names: {},
                            counts: {},
                            descriptions: {}
                        },
                        lastUpdated: new Date().toISOString()
                    };
                    
                    console.log('Updated project data to save:', updatedProjectData);
                    
                    // Save to cloud
                    if (JSONBIN_BIN_ID) {
                        const response = await fetch(`${JSONBIN_URL}/${JSONBIN_BIN_ID}`, {
                            method: 'PUT',
                            headers: {
                                'Content-Type': 'application/json',
                                'X-Master-Key': JSONBIN_API_KEY
                            },
                            body: JSON.stringify(updatedProjectData)
                        });
                        
                        if (response.ok) {
                            console.log('Cloud updated successfully with live data');
                            
                            // Update local data
                            projectData = updatedProjectData;
                            applyProjectDataToDOM();
                            localStorage.setItem('projectRalphData', JSON.stringify(updatedProjectData));
                            
                            // Update localStorage values
                            localStorage.setItem('interactionProgress', updatedProjectData.interactions.current.toString());
                            localStorage.setItem('interactionCount', updatedProjectData.interactions.target.toString());
                            localStorage.setItem('dealershipCount', updatedProjectData.dealerships.target.toString());
                            
                            console.log('Local data updated to match live site');
                            return true;
                        } else {
                            console.error('Failed to update cloud');
                            return false;
                        }
                    } else {
                        console.error('No bin ID available');
                        return false;
                    }
                } else {
                    console.error('Could not get live site data');
                    return false;
                }
            } catch (error) {
                console.error('Error updating cloud with live data:', error);
                return false;
            }
        }

        // Feature editing functionality
        function editFeature(element) {
            const currentText = element.textContent;
            const featureItem = element.closest('.feature-item');
            
            // Convert to editing mode
            featureItem.classList.add('editing');
            featureItem.innerHTML = `
                <i class="fas fa-edit"></i>
                <input type="text" class="feature-input-inline" value="${currentText}" onkeypress="handleFeatureKeyPress(event, this)" onblur="saveFeature(this)" style="flex: 1; padding: 8px 12px; border: 1px solid #3b82f6; border-radius: 4px; font-size: 0.875rem; outline: none; background: white;">
                <button class="feature-delete" onclick="deleteFeature(this)" aria-label="Delete feature">×</button>
            `;
            
            // Focus and select all text
            const input = featureItem.querySelector('.feature-input-inline');
            input.focus();
            input.select();
        }

        function handleFeatureKeyPress(event, input) {
            if (event.key === 'Enter') {
                saveFeature(input);
            } else if (event.key === 'Escape') {
                cancelFeatureEdit(input);
            }
        }

        function saveFeature(input) {
            const text = input.value.trim();
            const featureItem = input.closest('.feature-item');
            
            if (text) {
                // Convert to regular feature item
                featureItem.classList.remove('editing');
                featureItem.innerHTML = `
                    <i class="fas fa-cog"></i>
                    <span class="feature-text" onclick="editFeature(this)">${text}</span>
                    <button class="feature-delete" onclick="deleteFeature(this)" aria-label="Delete feature">×</button>
                `;
                saveFeatures();
                saveDataToCloud(); // Save to cloud
            } else {
                // Remove empty feature
                featureItem.remove();
            }
        }

        function cancelFeatureEdit(input) {
            const featureItem = input.closest('.feature-item');
            const savedFeatures = loadFeatures();
            const index = Array.from(featureItem.parentElement.children).indexOf(featureItem);
            
            if (savedFeatures[index]) {
                featureItem.classList.remove('editing');
                featureItem.innerHTML = `
                    <i class="fas fa-cog"></i>
                    <span class="feature-text" onclick="editFeature(this)">${savedFeatures[index]}</span>
                    <button class="feature-delete" onclick="deleteFeature(this)" aria-label="Delete feature">×</button>
                `;
            } else {
                featureItem.remove();
            }
        }

        function deleteFeature(button) {
            button.parentElement.remove();
            saveFeatures();
            saveDataToCloud(); // Save to cloud
        }

        function addNewFeature() {
            const featureList = document.getElementById('feature-list');
            const li = document.createElement('li');
            li.className = 'feature-item editing';
            li.innerHTML = `
                <i class="fas fa-edit"></i>
                <input type="text" class="feature-input-inline" placeholder="Type your feature here..." onkeypress="handleFeatureKeyPress(event, this)" onblur="saveFeature(this)" style="flex: 1; padding: 8px 12px; border: 1px solid #3b82f6; border-radius: 4px; font-size: 0.875rem; outline: none; background: white;">
                <button class="feature-delete" onclick="deleteFeature(this)" aria-label="Delete feature">×</button>
            `;
            featureList.appendChild(li);
            
            // Focus on the input
            const input = li.querySelector('.feature-input-inline');
            input.focus();
        }

        // Save features to localStorage and cloud
        function saveFeatures() {
            const featureItems = document.querySelectorAll('.feature-item');
            const features = [];
            
            featureItems.forEach(item => {
                const text = item.querySelector('.feature-text');
                if (text) {
                    features.push(text.textContent);
                }
            });
            
            localStorage.setItem('projectRalphFeatures', JSON.stringify(features));
        }

        // Load features from localStorage and cloud
        function loadFeatures() {
            const savedFeatures = localStorage.getItem('projectRalphFeatures');
            if (savedFeatures) {
                const features = JSON.parse(savedFeatures);
                const featureList = document.getElementById('feature-list');
                
                // Clear existing features
                featureList.innerHTML = '';
                
                // Add saved features
                features.forEach(feature => {
                    const li = document.createElement('li');
                    li.className = 'feature-item';
                    li.innerHTML = `
                        <i class="fas fa-cog"></i>
                        <span class="feature-text" onclick="editFeature(this)">${feature}</span>
                        <button class="feature-delete" onclick="deleteFeature(this)" aria-label="Delete feature">×</button>
                    `;
                    featureList.appendChild(li);
                });
                
                return features;
            }
            return [];
        }

        // Load saved metric values
        function loadSavedMetrics() {
            const savedDealershipCount = localStorage.getItem('dealershipCount');
            const savedInteractionCount = localStorage.getItem('interactionCount');
            
            if (savedDealershipCount) {
                document.getElementById('dealership-count').textContent = savedDealershipCount;
            }
            if (savedInteractionCount) {
                document.getElementById('interaction-count').textContent = parseInt(savedInteractionCount).toLocaleString();
            }
        }

        // Initialize everything with proper loading sequence
        async function initializeApp() {
            console.log('=== INITIALIZING APP ===');
            
            // Show loading state
            showLoadingState();
            
            // Set up date display immediately
            updateDateDisplay();
            
            // Check if we have a bin ID, if not try to sync
            if (!JSONBIN_BIN_ID) {
                console.log('No bin ID found, attempting to sync with live site...');
                await createNewBinAndSync();
            }
            
            // Load all data in parallel for faster loading
            const loadPromises = [
                loadDataFromCloud(),
                loadSavedMetrics(),
                loadTodos(),
                loadTierData(),
                loadFeatures()
            ];
            
            // Wait for all data to load
            await Promise.all(loadPromises);
            
            // Update all displays
            updateProgress();
            updateTodoStats();
            
            // Debug the final state
            setTimeout(() => {
                debugCurrentState();
                hideLoadingState();
            }, 100);
        }

        // Initialize the app when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeApp);
        } else {
            initializeApp();
        }

        // Update date display every minute
        setInterval(updateDateDisplay, 60000);
    </script>
</body>
</html> 